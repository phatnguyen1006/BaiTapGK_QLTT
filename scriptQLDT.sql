CREATE DATABASE QLDT
GO
USE QLDT
GO

SET DATEFORMAT DMY
GO

-- TABLE
CREATE TABLE SINHVIEN
(
    MSSV    char(8) PRIMARY KEY,
    TENSV   nvarchar(30) not null,
    SODT    varchar(10),
    LOP     char(10) not null,
    DIACHI  nchar(50) not null,
)

CREATE TABLE DETAI
(
    MSDT    char(6) PRIMARY KEY,
    TENDT   nvarchar(30) not null,
)

CREATE TABLE SV_DETAI
(
    MSSV    char(8) REFERENCES SINHVIEN(MSSV),
    MSDT    char(6) REFERENCES DETAI(MSDT),
)

CREATE TABLE HOCVI
(
    MSHV    int PRIMARY KEY,
    TENHV   nvarchar(20) not null,
)

CREATE TABLE CHUYENNGANH
(
    MSCN    int PRIMARY KEY,
    TENCN   nvarchar(30) not null,
)

CREATE TABLE HOCHAM
(
    MSHH    int PRIMARY KEY,
    TENHH   nvarchar(20) not null,
)

CREATE TABLE GIAOVIEN
(
    MSGV    int PRIMARY KEY,
    TENGV   nvarchar(30) not null,
    DIACHI  nvarchar(50) not null, 
    SODT    varchar(10) not null, 
    MSHH    int REFERENCES HOCHAM(MSHH),
    NAMHH   smalldatetime not null,
)

CREATE TABLE GV_HV_CN
(
    MSGV    int REFERENCES GIAOVIEN(MSGV),
    MSHV    int REFERENCES HOCVI(MSHV),
    MSCN    int REFERENCES CHUYENNGANH(MSCN),
    NAM     smalldatetime not null,

    constraint PK_GV_HV_CN primary key(MSGV, MSHV, MSCN)
)

CREATE TABLE GV_HDDT
(
    MSGV int REFERENCES GIAOVIEN(MSGV),
    MSDT char(6) REFERENCES DETAI(MSDT),
    DIEM float not null,

    constraint PK_GV_HDDT primary key(MSGV, MSDT)
)

CREATE TABLE GV_PBDT
(
    MSGV int REFERENCES GIAOVIEN(MSGV),
    MSDT char(6) REFERENCES DETAI(MSDT),
    DIEM float not null,

    constraint PK_GV_PBDT primary key(MSGV, MSDT)
)

CREATE TABLE GV_UVDT
(
    MSGV int REFERENCES GIAOVIEN(MSGV),
    MSDT char(6) REFERENCES DETAI(MSDT),
    DIEM float not null,

    constraint PK_GV_UVDT primary key(MSGV, MSDT)
)

CREATE TABLE HOIDONG
(
    MSHD        int PRIMARY KEY,
    PHONG       int,
    TGBD        smalldatetime,
    NGAYHD      smalldatetime not null,
    TINHTRANG   nvarchar(30) not null,
    MSGV        int REFERENCES GIAOVIEN(MSGV),
)

CREATE TABLE HOIDONG_GV
(
    MSHD    int REFERENCES HOIDONG(MSHD),
    MSGV    int REFERENCES GIAOVIEN(MSGV),

    constraint PK_HOIDONG_GV primary key(MSHD, MSGV)
)

CREATE TABLE HOIDONG_DT
(
    MSHD        int REFERENCES HOIDONG(MSHD),
    MSDT        char(6) REFERENCES DETAI(MSDT),
    QUYETDINH   nchar(10),

    constraint PK_HOIDONG_DT primary key(MSHD, MSDT)
)

-- PRIMARY KEYS AND FOREIGNS
GO
alter table GIAOVIEN add constraint FK_GV_HH foreign key(MSHH) references HOCHAM(MSHH)

GO
--- A.BẢNG SINHVIEN
INSERT INTO SINHVIEN VALUES('13520001',N'Nguyễn Văn An','0906762255','SE103.U32',N'THỦ ĐỨC')
INSERT INTO SINHVIEN VALUES('13520002',N'Phan Tấn Đạt','0975672350','IE204.T21',N'QUẬN 1')
INSERT INTO SINHVIEN VALUES('13520003',N'Nguyễn Anh Hải','0947578688','IE205.R12',N'QUẬN 9')
INSERT INTO SINHVIEN VALUES('13520004',N'Phạm Tài','0956757869','IE202.A22',N'QUẬN 1')
INSERT INTO SINHVIEN VALUES('13520005',N'Lê Thúy Hằng','0976668688','SE304.E22',N'THỦ ĐỨC')
INSERT INTO SINHVIEN VALUES('13520006',N'Ưng Hồng Ân','0957475898','IE208.F33',N'QUẬN 2')

---B.BẢNG DETAI
INSERT INTO DETAI VALUES('97001',N'Quản lý thư viện')
INSERT INTO DETAI VALUES('97002',N'Nhận dạng vân tay')
INSERT INTO DETAI VALUES('97003',N'Bán đấu giá trên mạng')
INSERT INTO DETAI VALUES('97004',N'Quản lý siêu thị')
INSERT INTO DETAI VALUES('97005',N'Xử lý ảnh')
INSERT INTO DETAI VALUES('97006',N'Hệ giải toán thông minh')

---C.BẢNG SV_DETAI
INSERT INTO SV_DETAI VALUES('13520001','97004')
INSERT INTO SV_DETAI VALUES('13520002','97005')
INSERT INTO SV_DETAI VALUES('13520003','97001')
INSERT INTO SV_DETAI VALUES('13520004','97002')
INSERT INTO SV_DETAI VALUES('13520005','97003')
INSERT INTO SV_DETAI VALUES('13520006','97005')
--D. BẢNG HOCHAM
INSERT INTO HOCHAM VALUES(1,N'PHÓ GIÁO SƯ')
INSERT INTO HOCHAM VALUES(2,N'GIÁO SƯ')
---E. BẢNG GIAOVIEN
INSERT INTO GIAOVIEN VALUES(00201,N'Trần Trung',N'Bến Tre','35353535',1,'1996')
INSERT INTO GIAOVIEN VALUES(00202,N'Nguyễn Văn An',N'Tiền Giang','67868688',1,'1996')
INSERT INTO GIAOVIEN VALUES(00203,N'Trần Thu Trang',N'Cần Thơ','74758687',1,'1996')
INSERT INTO GIAOVIEN VALUES(00204,N'Nguyễn Thị Loan',N'TP. HCM','56575868',2,'2005')
INSERT INTO GIAOVIEN VALUES(00205,N'Chu Tiến',N'Hà Nội','46466646',2,'2005')
---F.BẢNG HOCVI
INSERT INTO HOCVI VALUES(1,N'Kỹ sư')
INSERT INTO HOCVI VALUES(2,N'Cử Nhân')
INSERT INTO HOCVI VALUES(3,N'Thạc sĩ')
INSERT INTO HOCVI VALUES(4,N'Tiến sĩ')
INSERT INTO HOCVI VALUES(5,N'Tiến sĩ Khoa học')	
---G. BẢNG CHUYENNGANH
INSERT INTO CHUYENNGANH VALUES(1,N'Công nghệ Web')
INSERT INTO CHUYENNGANH VALUES(2,N'Mạng xã hội')
INSERT INTO CHUYENNGANH VALUES(3,N'Quản lý CNTT')
INSERT INTO CHUYENNGANH VALUES(4,N'GIS')
---H. BẢNG GV_HV_CN
INSERT INTO GV_HV_CN VALUES(00201,1,1,'2013')
INSERT INTO GV_HV_CN VALUES(00201,1,2,'2013')
INSERT INTO GV_HV_CN VALUES(00201,2,1,'2014')
INSERT INTO GV_HV_CN VALUES(00202,3,2,'2013')
INSERT INTO GV_HV_CN VALUES(00203,2,4,'2014')
INSERT INTO GV_HV_CN VALUES(00204,3,2,'2014')
---I. BẢNG GV_HDDT
INSERT INTO GV_HDDT VALUES(00201,'97001',8)
INSERT INTO GV_HDDT VALUES(00202,'97002',7)
INSERT INTO GV_HDDT VALUES(00205,'97001',9)
INSERT INTO GV_HDDT VALUES(00204,'97004',7)
INSERT INTO GV_HDDT VALUES(00203,'97005',9)
---J. BẢNG GV_PBDT
INSERT INTO GV_PBDT VALUES(00201,'97005',8)
INSERT INTO GV_PBDT VALUES(00202,'97001',7)
INSERT INTO GV_PBDT VALUES(00205,'97004',9)
INSERT INTO GV_PBDT VALUES(00204,'97003',7)
INSERT INTO GV_PBDT VALUES(00203,'97002',9)
---K. BẢNG GV_UVDT
INSERT INTO GV_UVDT VALUES(00205,'97005',8)
INSERT INTO GV_UVDT VALUES(00202,'97005',7)
INSERT INTO GV_UVDT VALUES(00204,'97005',9)
INSERT INTO GV_UVDT VALUES(00203,'97001',7)
INSERT INTO GV_UVDT VALUES(00204,'97001',9)
INSERT INTO GV_UVDT VALUES(00205,'97001',8)
INSERT INTO GV_UVDT VALUES(00203,'97003',7)
INSERT INTO GV_UVDT VALUES(00201,'97003',9)
INSERT INTO GV_UVDT VALUES(00202,'97003',7)
INSERT INTO GV_UVDT VALUES(00201,'97004',9)
INSERT INTO GV_UVDT VALUES(00202,'97004',8)
INSERT INTO GV_UVDT VALUES(00203,'97004',7)
INSERT INTO GV_UVDT VALUES(00201,'97002',9)
INSERT INTO GV_UVDT VALUES(00204,'97002',7)
INSERT INTO GV_UVDT VALUES(00205,'97002',9)
---L. BẢNG HOIDONG
INSERT INTO HOIDONG VALUES(1,002,'7:00','29/11/2014',N'Thật',00201)
INSERT INTO HOIDONG VALUES(2,102,'7:00','5/12/2014',N'Thật',00202)
INSERT INTO HOIDONG VALUES(3,003,'8:00','6/12/2014',N'Thật',00203)
---M. BẢNG HOIDONG_GV
INSERT INTO HOIDONG_GV VALUES(1,00201)
INSERT INTO HOIDONG_GV VALUES(1,00202)
INSERT INTO HOIDONG_GV VALUES(1,00203)
INSERT INTO HOIDONG_GV VALUES(1,00204)
INSERT INTO HOIDONG_GV VALUES(2,00203)
INSERT INTO HOIDONG_GV VALUES(2,00202)
INSERT INTO HOIDONG_GV VALUES(2,00205)
INSERT INTO HOIDONG_GV VALUES(2,00204)
INSERT INTO HOIDONG_GV VALUES(3,00201)
INSERT INTO HOIDONG_GV VALUES(3,00202)
INSERT INTO HOIDONG_GV VALUES(3,00203)
INSERT INTO HOIDONG_GV VALUES(3,00204)
---N. BẢNG HOIDONG_DT
INSERT INTO HOIDONG_DT VALUES(1,'97001',N'Được')
INSERT INTO HOIDONG_DT VALUES(1,'97002',N'Được')
INSERT INTO HOIDONG_DT VALUES(2,'97001',N'Không')
INSERT INTO HOIDONG_DT VALUES(2,'97004',N'Không')
INSERT INTO HOIDONG_DT VALUES(1,'97005',N'Được')
INSERT INTO HOIDONG_DT VALUES(3,'97001',N'Không')
INSERT INTO HOIDONG_DT VALUES(3,'97002',N'Được')

GO
use master
-- GO
-- DROP DATABASE QLDT